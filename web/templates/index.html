{% with page_title = test_page_title %}
  {% include 'header.html' %}
{% endwith %}
  <body id="page-top">

    {% include 'nav.html' %}

    <div id="wrapper">

      {% include 'sidebar.html' %}

      <div id="content-wrapper">

        <div class="container-fluid">

        {% include 'breadcrumb.html' %}

          <!-- Icon Cards
          <div class="row">
            <div class="col-xl-3 col-sm-6 mb-3">
              <div class="card text-white bg-primary o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fas fa-fw fa-comments"></i>
                  </div>
                  <div class="mr-5">26 New Messages!</div>
                </div>
                <a class="card-footer text-white clearfix small z-1" href="#">
                  <span class="float-left">View Details</span>
                  <span class="float-right">
                    <i class="fas fa-angle-right"></i>
                  </span>
                </a>
              </div>
            </div>
            <div class="col-xl-3 col-sm-6 mb-3">
              <div class="card text-white bg-warning o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fas fa-fw fa-list"></i>
                  </div>
                  <div class="mr-5">11 New Tasks!</div>
                </div>
                <a class="card-footer text-white clearfix small z-1" href="#">
                  <span class="float-left">View Details</span>
                  <span class="float-right">
                    <i class="fas fa-angle-right"></i>
                  </span>
                </a>
              </div>
            </div>
            <div class="col-xl-3 col-sm-6 mb-3">
              <div class="card text-white bg-success o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fas fa-fw fa-shopping-cart"></i>
                  </div>
                  <div class="mr-5">123 New Orders!</div>
                </div>
                <a class="card-footer text-white clearfix small z-1" href="#">
                  <span class="float-left">View Details</span>
                  <span class="float-right">
                    <i class="fas fa-angle-right"></i>
                  </span>
                </a>
              </div>
            </div>
            <div class="col-xl-3 col-sm-6 mb-3">
              <div class="card text-white bg-danger o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fas fa-fw fa-life-ring"></i>
                  </div>
                  <div class="mr-5">13 New Tickets!</div>
                </div>
                <a class="card-footer text-white clearfix small z-1" href="#">
                  <span class="float-left">View Details</span>
                  <span class="float-right">
                    <i class="fas fa-angle-right"></i>
                  </span>
                </a>
              </div>
            </div>
          </div>
          <!-- Area Chart Example-->
          <style>
            .btn-group > * {
              display: inline-block;
              margin-left: 8px;
              width: 25%;
            }
            #datepicker-container > * {
              width: 20%;
              margin-bottom: 1rem;
              margin-right: 0rem;
              float: right;
            }
          </style>

          <div class="card mb-3">
            <div class="card-header">
              <i class="fas fa-chart-area"></i>
              Customer Satisfaction Graph
              <div class="btn-group" style="float: right; width: 40%">
                <div>
                  <input value="Daily" class="btn btn-primary btn-block" onclick="changeDatePicker('date')">
                </div>
                <div>
                  <input value="Weekly" class="btn btn-primary btn-block" onclick="changeDatePicker('week')">
                </div>
                <div>
                  <input value="Monthly" class="btn btn-primary btn-block" onclick="changeDatePicker('month')">
                </div>
                <div>
                  <input value="Yearly" class="btn btn-primary btn-block" onclick="changeDatePicker('year')">
                </div>
              </div>

              <script type="text/javascript">
                var options = "";

                function populateYearOptions(){
                  if (options.length > 1){
                    return options
                  }
                  for (i = 0; i < 20; i++){
                    var fillstr = i.toString();
                    if (fillstr.length < 2){
                      fillstr = "0" + fillstr;
                    }
                    options += "<option>20" + fillstr + "</option>";
                  }
                }

                function changeDatePicker(inputType){
                  var decoration = "id='date-picker' class='form-control form-control-sm' onchange='alertOnDateChange(this)'";
                  populateYearOptions();
                  if (inputType == "year"){
                    document.getElementById("datepicker-container").innerHTML = "<select name='year'" + decoration + ">" + options + "</select>";
                  } else {
                    document.getElementById("datepicker-container").innerHTML = "<input name='" + inputType + "' type=" + inputType + " " + decoration + ">";
                  }
                }

                function alertOnDateChange(elem){
                  $.getJSON('/api/reporting/' + elem.name + '?dateString=' + $("#date-picker").val(), function(data){
                    myLineChart.data.datasets[0].data = [];
                    myLineChart.data.labels = [];
                    var table = $('#dataTable').DataTable();
                    table.clear();
                    for(i = 0; i < data.length; i++){
                      table.row.add([
                        data[i].date,
                        data[i].description,
                        data[i].table_id,
                        data[i].staff_id,
                        data[i].reservation_id,
                        data[i].score,
                      ]).draw( false );

                      myLineChart.data.datasets[0].data.push(data[i].score);
                      myLineChart.data.labels.push(data[i].date);
                    }
                    myLineChart.update();
                  })
                }

                window.onload = function(e){
                  alertOnDateChange(document.getElementById('date-picker'));
                }
              </script>

          </div>
            <div class="card-body">
              <div id="datepicker-container">
                <input name="date" type="date" value="2018-11-08" id="date-picker" class="form-control form-control-sm" onchange="alertOnDateChange(this)">
              </div>
              <!--<select style="margin-bottom: 1rem; margin-right: 5.5rem; float: right">
                <option selected="selected">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;</option>
              </select>-->
              <canvas id="myAreaChart" width="100%" height="30"></canvas>
            </div>
            <div class="card-footer small text-muted">Updated yesterday at 11:59 PM</div>
          </div>

          <!-- DataTables Example -->
          <div class="card mb-3">
            <div class="card-header">
              <i class="fas fa-table"></i>
              Data Table Example</div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Event Description</th>
                      <th>Table Number</th>
                      <th>Staff ID</th>
                      <th>Reservation ID</th>
                      <th>Satisfaction Score</th>
                    </tr>
                  </thead>
                  <tfoot>
                    <tr>
                      <th>Date</th>
                      <th>Event Description</th>
                      <th>Table Number</th>
                      <th>Staff ID</th>
                      <th>Reservation ID</th>
                      <th>Satisfaction Score</th>
                    </tr>
                  </tfoot>
                  <tbody>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="card-footer small text-muted">Updated yesterday at 11:59 PM</div>
          </div>

        </div>
        <!-- /.container-fluid -->

        <!-- Sticky Footer -->
        <footer class="sticky-footer">
          <div class="container my-auto">
            <div class="copyright text-center my-auto">
              <span>Copyright Â© Your Website 2018</span>
            </div>
          </div>
        </footer>

      </div>
      <!-- /.content-wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
      <i class="fas fa-angle-up"></i>
    </a>
  </body>
 {% include 'footer.html' %}
</html>
