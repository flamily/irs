{% with page_title = test_page_title %}
  {% include 'header.html' %}
{% endwith %}
  <body id="page-top">

    {% include 'nav.html' %}

    <div id="wrapper">

      {% include 'sidebar.html' %}

      <div id="content-wrapper">

        <div class="container-fluid">

        {% include 'breadcrumb.html' %}
        <script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.18/datatables.min.js"></script>
        <script type="text/javascript" src="https://cdn.datatables.net/plug-ins/1.10.19/sorting/datetime-moment.js"></script>
          <!-- Icon Cards
          <div class="row">
            <div class="col-xl-3 col-sm-6 mb-3">
              <div class="card text-white bg-primary o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fas fa-fw fa-comments"></i>
                  </div>
                  <div class="mr-5">26 New Messages!</div>
                </div>
                <a class="card-footer text-white clearfix small z-1" href="#">
                  <span class="float-left">View Details</span>
                  <span class="float-right">
                    <i class="fas fa-angle-right"></i>
                  </span>
                </a>
              </div>
            </div>
            <div class="col-xl-3 col-sm-6 mb-3">
              <div class="card text-white bg-warning o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fas fa-fw fa-list"></i>
                  </div>
                  <div class="mr-5">11 New Tasks!</div>
                </div>
                <a class="card-footer text-white clearfix small z-1" href="#">
                  <span class="float-left">View Details</span>
                  <span class="float-right">
                    <i class="fas fa-angle-right"></i>
                  </span>
                </a>
              </div>
            </div>
            <div class="col-xl-3 col-sm-6 mb-3">
              <div class="card text-white bg-success o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fas fa-fw fa-shopping-cart"></i>
                  </div>
                  <div class="mr-5">123 New Orders!</div>
                </div>
                <a class="card-footer text-white clearfix small z-1" href="#">
                  <span class="float-left">View Details</span>
                  <span class="float-right">
                    <i class="fas fa-angle-right"></i>
                  </span>
                </a>
              </div>
            </div>
            <div class="col-xl-3 col-sm-6 mb-3">
              <div class="card text-white bg-danger o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fas fa-fw fa-life-ring"></i>
                  </div>
                  <div class="mr-5">13 New Tickets!</div>
                </div>
                <a class="card-footer text-white clearfix small z-1" href="#">
                  <span class="float-left">View Details</span>
                  <span class="float-right">
                    <i class="fas fa-angle-right"></i>
                  </span>
                </a>
              </div>
            </div>
          </div>
          <!-- Area Chart Example-->
          <style>
            .btn-group > * {
              display: inline-block;
              margin-left: 8px;
              width: 25%;
            }

            .inline-elemnts > * {
              display: inline-block;
            }

            .graph-mode-buttons > * {
              display: inline-block;
              margin-left: 8px;
              width: 32%;
              margin-bottom: 20px;
            }

            .graph_footer > * {
              display: inline-block;
              margin-left: 8px;
            }

            #datepicker-container > * {
              margin-bottom: 1rem;
              margin-right: 2rem;
              float: right;
            }

            #date-picker {
              float: right;
              width:70%;
            }
          </style>

          <script type="text/javascript">
            var options = "";
            var mode = "Customer";

            function populateYearOptions(){
              if (options.length > 1){
                return options
              }
              for (i = 0; i < 20; i++){
                var fillstr = i.toString();
                if (fillstr.length < 2){
                  fillstr = "0" + fillstr;
                }
                options += "<option>20" + fillstr + "</option>";
              }
            }

            function changeDatePicker(inputType){
              var decoration = "id='date-picker' class='form-control form-control-sm' onchange='alertOnDateChange()'";
              populateYearOptions();
              if (inputType == "year"){
                document.getElementById("date-picker-module").innerHTML = "<select name='year'" + decoration + ">" + options + "</select>";
              } else {
                document.getElementById("date-picker-module").innerHTML = "<input name='" + inputType + "' type=" + inputType + " " + decoration + ">";
              }
            }

            function alertOnDateChange(){
              var date_type = document.getElementById('date-picker').getAttribute("name");
              var date_string = $("#date-picker").val();
              var item_selector_value = $("select#item-selector>option:selected").attr("value");
              if (mode == "Customer"){
                  var api_string = '/api/reporting/' + mode + '/' + date_type + '?dateString=' + date_string;
              } else {
                var api_string = '/api/reporting/' + mode + '/' + item_selector_value + '/' + date_type + '?dateString=' + date_string;
              }

              $.getJSON(api_string, function(data){
                document.getElementById("average_score").innerHTML = "<strong>Average Score: " + data.average + "</strong>"
                myLineChart.data.datasets[0].data = data.scores;
                myLineChart.data.labels = data.labels;
                myLineChart.update();
              });

              myDataTable.ajax.url(api_string).load();
            }

            function changeGraphMode(elem){
              mode = elem.name;
              document.getElementById("graph_title").innerHTML = elem.name + " Satisfaction Graph";

              if (elem.name == "Customer"){
                document.getElementById('item-selector-area').style.display = "none";
              } else {
                document.getElementById('item-selector-area').style.display = "block";
                document.getElementById('item-select-label').innerHTML = elem.name + " ID";
              }
            }

            window.onload = function(e){
              document.getElementById('item-selector-area').style.display = "none";
              mode = "Customer";
              alertOnDateChange(document.getElementById('date-picker'));
            }
          </script>

          <div class="graph-mode-buttons">
            <div>
              <input name="Customer" value="Customer Satisfaction" class="btn btn-primary btn-block" onclick="changeGraphMode(this)">
            </div>
            <div>
              <input name="Staff" value="Staff Performance" class="btn btn-primary btn-block" onclick="changeGraphMode(this)">
            </div>
            <div>
              <input name="Meal" value="Meal Trends" class="btn btn-primary btn-block" onclick="changeGraphMode(this)">
            </div>
          </div>

          <div class="card mb-3">
            <div class="card-header">
              <i class="fas fa-chart-area"></i>
              <span id="graph_title">Customer Satisfaction Graph</span>
              <div class="btn-group" style="float: right; width: 40%">
                <div>
                  <input value="Daily" class="btn btn-primary btn-block" onclick="changeDatePicker('date')">
                </div>
                <div>
                  <input value="Weekly" class="btn btn-primary btn-block" onclick="changeDatePicker('week')">
                </div>
                <div>
                  <input value="Monthly" class="btn btn-primary btn-block" onclick="changeDatePicker('month')">
                </div>
                <div>
                  <input value="Yearly" class="btn btn-primary btn-block" onclick="changeDatePicker('year')">
                </div>
              </div>
            </div>

            <div class="card-body">
              <div class="inline-elements">
                <div id="item-selector">

                </div>
                <div id="datepicker-container">
                  <span id="item-selector-area" style="float: left; width: 30%; display: none">
                    <label id="item-select-label" for="item-selector" style="float: left; padding-right: 3rem">Staff ID: </label>
                    <span id="item-selector-module">
                    <select id="item-selector" style="float: left; width:70%" class="form-control form-control-sm" onchange='alertOnDateChange()'>
                      <option value="0">0</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                      <option value="6">6</option>
                    </select>
                    </span>
                  </span>
                  <span id="date-picker-area" style="float: right; width: 30%">
                    <label id="date-picker-label" for="date-picker">Date: </label>
                    <span id="date-picker-module">
                      <input name="date" type="date" value="2018-11-08" id="date-picker" class="form-control form-control-sm" onchange="alertOnDateChange()">
                    </span>
                  </span>
                </div>
              </div>
              <canvas id="myAreaChart" width="100%" height="30"></canvas>
            </div>
            <div class="card-footer small text-muted graph_footer">
              <span id="average_score"><strong>Average Satisfaction:</strong></span>
              <span style="float: right">Updated yesterday at 11:59 PM</span>
            </div>
          </div>

          <!-- DataTables Example -->
          <div class="card mb-3">
            <div class="card-header">
              <i class="fas fa-table"></i>
              Data Table Example</div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Event Description</th>
                      <th>Table Number</th>
                      <th>Staff ID</th>
                      <th>Reservation ID</th>
                      <th>Satisfaction Score</th>
                    </tr>
                  </thead>
                  <tfoot>
                    <tr>
                      <th>Date</th>
                      <th>Event Description</th>
                      <th>Table Number</th>
                      <th>Staff ID</th>
                      <th>Reservation ID</th>
                      <th>Satisfaction Score</th>
                    </tr>
                  </tfoot>
                  <tbody>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="card-footer small text-muted">Updated yesterday at 11:59 PM</div>
          </div>

        </div>
        <!-- /.container-fluid -->

        <!-- Sticky Footer -->
        <footer class="sticky-footer">
          <div class="container my-auto">
            <div class="copyright text-center my-auto">
              <span>Copyright Â© Your Website 2018</span>
            </div>
          </div>
        </footer>

      </div>
      <!-- /.content-wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
      <i class="fas fa-angle-up"></i>
    </a>
  </body>
 {% include 'footer.html' %}
</html>
